CREATE OR REPLACE VIEW public."AI_Tool_OutputTable_v2"
 AS
 SELECT o.client_type,
    o.customername AS "Customer Name",
    o.customerid AS "Client ID",
    o."20DigitSKU" AS "SKU Number",
    o."13DigitAlias" AS "13 Digit SKU",
    o.orderqty AS "Quantity",
    o.reference_no AS "PO or Ref",
    o.delivery_address AS "Alt. Delivery Address",
    o.street_address,
    o.postcode,
    o.city,
    o.province,
    o.valve_description AS "Valve",
    o.cut AS "Corte",
    o.unitprice_beforediscount AS "PriceBeforeDiscount",
    o.total_discount AS "Discount",
    o.unitprice AS "Net Price",
    o.orderno AS "AIOrderNo",
    o.orderline AS "LinPed",
    o.cpsd AS "CCPSD",
    o.cpsd AS "CPSD",
    o.tax AS "Tax",
    o.tarifatax AS "TarifaTax",
    o.claveiorder AS "ClaveiOrder",
    o.integrationdate AS "Integration Date",
    o.error AS "Error",
    e.date_time_received AS email_timestamp,
    e.subject AS email_subject,
    o.emailaddress,
    e.cleaned_body AS email_body,
    o.order_type,
    o.email_id,
    o.email_directory,
    o.telephone_number,
    o.contact_name,
    o.job_id
   FROM ai_tool_output_table o
     LEFT JOIN email_orders e ON o.email_id::text = e.email_id::text
  WHERE o.claveiorder IS NULL;